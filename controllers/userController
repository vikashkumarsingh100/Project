const users=require('../models/user')
const posts=require('../models/post')
const express = require("express");

module.exports.data=async function(req,res){
    // console.log(req.user)
  if(req.user)
  { var a=await posts.find().populate('user');
  return res.render('index',{posts1:a})
  }
  console.log('comment')

return res.render('index');}
   

module.exports.createSession=function(req,res){
    return res.redirect('/')
}

module.exports.create=async function(req,res){
    // console.log(req.body.password)
user=await users.findOne({email:req.body.email})

    if(user)
    {
        res.send('already a user')
    }
    else{
        await users.create(req.body)
    }
   

    return res.redirect('/sign-in')
}
module.exports.post=async function(req,res){
    await posts.create(
        {content:req.body.content,user:req.user._id});
        var comment=await posts.find({user:req.user._id})

         var a=await posts.find().populate('user');
  return res.render('index',{posts1:a})
  
        // console.log(comment)
   
}
